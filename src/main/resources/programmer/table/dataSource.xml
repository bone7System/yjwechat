<?xml version="1.0" encoding="UTF-8"?>
<dataSources>
    <dataSource id="yj_background_dmk_cl">
        <description>代码常量数据</description>
        <sql>
            select t.pkid,t.dm,t.mc,t.jc,t.pxh,t.bq,t.zt,t1.dmbz,t1.dmmc  from yj_dmk_cl t
            left join yj_dmk_fl t1 on t1.dmbz=t.dmbz
        </sql>
    </dataSource>
    <dataSource id="yj_erp_commondity">
        <description>进销存-商品列表</description>
        <sql>
            select t.id as spid,t.spbm,t.spmc,t.spms,t.splxdm,t.sppp,t.mdid,t1.id as spxqid,t1.gg,t1.dj,t1.dwdm,t2.id as spjgid,t2.bzjg,t3.mc as dw,t4.mc as splx
            from erp_commodity t
            left join erp_commodity_detail t1 on t1.spid=t.id
            left join erp_commodity_price t2 on t2.spxqid=t1.id
            left join yj_dmk_cl t3 on t3.dmbz='DW' and t3.dm=t1.dwdm
            left join yj_dmk_cl t4 on t4.dmbz='SPLX' and t4.dm=t.splxdm
            where t.del_flag=0
        </sql>
    </dataSource>
    <dataSource id="yj_erp_menu">
        <description>进销存-菜单管理</description>
        <sql>
            SELECT t.id,t.title,t.url,t.icon,t.parentId,t.isDirectory,t.sort,t.del_flag,t.createTime,t.path ,t1.title as parent_title
            FROM erp_menu t
            left join erp_menu t1 on t.parentId=t1.id
            where ifnull(t.del_flag,0)!=-1
        </sql>
    </dataSource>
    <dataSource id="yj_erp_permission">
        <description>进销存-权限管理</description>
        <sql>
            SELECT
            t.id,t.menuId,t.permission,t.parentId,t.createTime,t.createUser,t.description,t.sort,t.path,t1.title as menuTitle,t2.permission as parentPermission
            FROM erp_permission  t
            left join erp_menu t1 on t1.id=t.menuId
            left join erp_permission t2 on t2.id=t.parentId
        </sql>
    </dataSource>
    <dataSource id="yj_erp_dept">
        <description>进销存-部门管理</description>
        <sql>
            SELECT
            t.id,t.client,t.deptName,t.parentId,t.isSystem,t.createTime,t.createUser,t1.deptName AS parentDeptName,IFNULL(t.`status`,0) as `status`,t.path
            FROM erp_dept t
            left join erp_dept t1 on t1.id=t.parentId
            where IFNULL(t.`status`,0)=0
        </sql>
    </dataSource>
    <dataSource id="yj_erp_role">
        <description>进销存-权限管理</description>
        <sql>
            SELECT
            t.id,t.roleName,t.description,t3.name as createName,date_format(t.createTime,'%Y-%m-%d') as createTime
            ,group_concat(t2.permission  separator ',' ) as permission
            FROM erp_role t
            left join erp_role_permission t1 on t1.roleId=t.id and t1.client=t.client
            left join erp_permission t2 on t2.id=t1.permissionId
            left join erp_user_detail t3 on t3.userId=t2.createUser
            where t.client=1000 or t.client=#{client}
            group by t.id,t.roleName,t.description,t3.name,t.createTime
        </sql>
    </dataSource>
</dataSources>  
